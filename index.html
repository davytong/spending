<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>üí∏Salary Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />

<style>
body { font-family:"Poppins","KhmerOS",sans-serif; background:#f4f7fb; padding:20px; }
h1 { text-align:center; color:#0d6efd; font-weight:600; margin-bottom:20px; }
.card { border-radius:16px; transition:0.3s; }
.card:hover { transform:translateY(-3px); box-shadow:0 8px 16px rgba(0,0,0,0.15); }
.fixed { background:#eef2ff; padding:8px; border-radius:8px; margin-bottom:5px; font-weight:500; }
.expense { display:flex; justify-content:space-between; background:#f8f9fa; padding:6px 10px; border-radius:8px; margin-bottom:4px; align-items:center; font-size:14px; }
.over-card { border:2px solid #dc3545; background:#ffe6e6; }
.over { color:#dc3545; font-weight:600; }
.progress { height:14px; border-radius:20px; margin-top:5px; }
.lang-btn { position:fixed; top:15px; right:15px; z-index:10; }
.btn-small { padding:0.2rem 0.5rem; font-size:0.8rem; }

/* Modal */
#saveBtn { background-color:#28a745; color:white; transition:0.3s; width:100%; margin-bottom:5px; }
#saveBtn:hover { background-color:#218838; }
#deleteBtn { background-color:#dc3545; color:white; transition:0.3s; width:100%; }
#deleteBtn:hover { background-color:#c82333; }
#expName,#expCost,#expDate { margin-bottom:10px; }
</style>
</head>
<body>
<button class="btn btn-outline-primary lang-btn" id="langBtn">·ûÅ·üí·ûò·üÇ·ûö</button>
<h1 id="title"></h1>

<div class="container">
<div class="d-flex justify-content-between mb-3 flex-wrap">
<select id="monthSelect" class="form-select w-50 mb-2"></select>
<button class="btn btn-danger ms-2 mb-2" id="resetMonth">Reset ‚Ü∫</button>
</div>

<div class="row" id="tracker"></div>

<div class="card mt-4 shadow-sm">
<div class="card-body text-center fw-bold">
<span id="spentLabel"></span>: $<span id="grandSpent">0</span> |
<span id="remainLabel"></span>: $<span id="grandRemain">0</span>
</div>
</div>
</div>

<!-- MODAL -->
<div class="modal fade" id="expModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<div class="modal-header">
<h5 id="modalTitle"></h5>
<button class="btn-close" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body">
<input id="expName" class="form-control" placeholder="Item name" />
<input id="expCost" type="number" class="form-control" placeholder="Cost" />
<input id="expDate" type="date" class="form-control" />
</div>
<div class="modal-footer d-flex flex-column flex-sm-row justify-content-between">
<button class="btn" id="deleteBtn"></button>
<button class="btn" id="saveBtn"></button>
</div>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- ONLY JS PART CHANGED ‚Äî HTML & CSS SAME -->
<script>
const SALARY = 320;
const MAX_DAILY_FOOD = 4;

const i18n = {
en:{ title:"Salary Tracker", spent:"Spent", remain:"Remaining", over:"OVER",
add:"Add", edit:"Edit Expense", saveBtn:"Save", deleteBtn:"Delete",
items:{Food:"Food",Gas:"Gas",House:"House",Saving:"Saving",Oil:"Oil",Other:"Other"},
resetMonth:"Reset ‚Ü∫", needRemain:"Need remain", needSpend:"Need spend/day",
subtotal:"Subtotal"
},
km:{ title:"·ûè·û∂·ûö·û∂·ûÑ·ûÇ·üí·ûö·ûî·üã·ûÇ·üí·ûö·ûÑ·ûî·üí·ûö·û∂·ûÄ·üã·ûÅ·üÇ", spent:"·ûÖ·üÜ·ûé·û∂·ûô", remain:"·ûì·üÖ·ûü·ûõ·üã", over:"·ûõ·ûæ·ûü",
add:"·ûî·ûì·üí·ûê·üÇ·ûò", edit:"·ûÄ·üÇ·ûÖ·üÜ·ûé·û∂·ûô", saveBtn:"·ûö·ûÄ·üí·ûü·û∂·ûë·ûª·ûÄ", deleteBtn:"·ûõ·ûª·ûî",
items:{Food:"·û¢·û∂·û†·û∂·ûö",Gas:"·ûü·û∂·üÜ·ûÑ",House:"·ûï·üí·ûë·üá",Saving:"·ûü·ûì·üí·ûü·üÜ",Oil:"·ûî·üí·ûö·üÅ·ûÑ",Other:"·ûï·üí·ûü·üÅ·ûÑ·üó"},
resetMonth:"·ûü·üÜ·û¢·û∂·ûè ‚Ü∫", needRemain:"·ûè·üí·ûö·ûº·ûú·ûì·üÖ·ûü·ûõ·üã", needSpend:"·ûè·üí·ûö·ûº·ûú·ûÖ·üÜ·ûé·û∂·ûô/·ûê·üí·ûÑ·üÉ",
subtotal:"·ûü·ûö·ûª·ûî·ûö·ûÑ"
}
};

let lang = localStorage.getItem("lang") || "km";

const halves = [
{ key:"first", fixed:["Saving"], vars:["Food","Gas","Other"]},
{ key:"second", fixed:["House"], vars:["Food","Oil","Other"]}
];

const budgets = { Food:60, Gas:15, House:70, Saving:60, Oil:15, Other:25 };

const key = (h,c)=>`${monthSelect.value}-${h}-${c}`;
const load = k=>JSON.parse(localStorage.getItem(k)||"[]");
const save = (k,v)=>localStorage.setItem(k,JSON.stringify(v));

function daysLeft(half){
  const today = new Date();
  const d = today.getDate();
  if(half==="first") return Math.max(0, 15 - d + 1);
  const end = new Date(today.getFullYear(), today.getMonth()+1, 0).getDate();
  return Math.max(0, end - d + 1);
}

function render(){
  const t=i18n[lang];
  title.textContent=t.title;
  langBtn.textContent=lang==="en"?"·ûÅ·üí·ûò·üÇ·ûö":"EN";
  resetMonth.textContent=t.resetMonth;

  tracker.innerHTML="";
  let grand=0;

  halves.forEach(h=>{
    let halfTotal=0;
    let html=`<div class="col-md-6 mb-3">
    <div class="card shadow-sm">
    <div class="card-header bg-primary text-white">
    ${h.key==="first"?"1st Half":"2nd Half"}
    </div><div class="card-body">`;

    h.vars.forEach(v=>{
      const list=load(key(h.key,v)).sort((a,b)=>a.date.localeCompare(b.date));
      const spent=list.reduce((s,e)=>s+e.cost,0);
      const remain=(budgets[v]-spent).toFixed(2);
      halfTotal+=spent;

      let rows="";
      list.forEach((e,i)=>{
        rows+=`<div class="expense">
        <span>${e.date} | ${e.name}</span>
        <span>$${e.cost.toFixed(2)}
        <button class="btn btn-sm btn-light btn-small" onclick="edit('${h.key}','${v}',${i})">‚úèÔ∏è</button>
        </span></div>`;
      });

      let foodInfo="";
      if(v==="Food"){
        const dLeft=daysLeft(h.key);
        const mustRemain=(dLeft*MAX_DAILY_FOOD).toFixed(2);
        foodInfo=`<div class="mt-2 p-2 rounded" style="background:#eef6ff;font-size:14px">
        ${t.items.Food} ($${budgets.Food})<br>
        ${t.spent}: $${spent.toFixed(2)} | ${t.remain}: $${remain} | ${t.needRemain}: $${mustRemain}<br>
        üìÖ ${t.needSpend} ~$${MAX_DAILY_FOOD.toFixed(2)}/·ûê·üí·ûÑ·üÉ ·ûü·ûò·üí·ûö·û∂·ûî·üã ${dLeft} ·ûê·üí·ûÑ·üÉ
        </div>`;
      }

      html+=`
      <div class="card p-2 mb-2">
      <b>${t.items[v]} ($${budgets[v]})</b>
      <button class="btn btn-sm btn-primary float-end btn-small"
      onclick="add('${h.key}','${v}')">${t.add} ‚ûï</button>
      ${rows}
      <div>${t.spent}: $${spent.toFixed(2)} | ${t.remain}: $${remain}</div>
      ${foodInfo}
      </div>`;
    });

    html+=`
    <div class="card p-2 mt-2 text-center fw-bold" style="background:#eef2ff">
    ${t.subtotal}: $${halfTotal.toFixed(2)}
    </div></div></div></div>`;

    tracker.innerHTML+=html;
    grand+=halfTotal;
  });

  grandSpent.textContent=grand.toFixed(2);
  grandRemain.textContent=(SALARY-grand).toFixed(2);
}

langBtn.onclick=()=>{ lang=lang==="en"?"km":"en"; localStorage.setItem("lang",lang); render(); }
monthSelect.onchange=render;
resetMonth.onclick=()=>{ localStorage.clear(); render(); }
render();
</script>
</body>
</html>